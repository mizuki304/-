# 旅行サイト 要件定義（ドラフト v0.1）

## 0. 前提と狙い

本サイトの狙いは、友人グループのヨーロッパ旅行に必要な情報（行程、予約、予算、連絡、地図、チェック）を一箇所に集約し、旅行前の意思決定と旅行中の参照を迷わず回すことである。閲覧者は旅行メンバーに限定し、共通パスワードでサイト全体を保護する。編集は幹事（または数名）が行い、閲覧者は基本的に読むだけでよい設計とする。

技術前提は、GitHubでソースと課題管理、Vercelで公開と自動デプロイ、CodexとAntigravityで実装作業を加速する構成である。

## 1. MVP（最初に作る最小版）

MVPは「旅行中にスマホで困らない」ことを最優先にし、次のページと要素を必須とする。

1つ目はトップページである。ここには「今日（または次）の予定」「次の集合情報（日時・場所・地図リンク）」「重要リンク（航空券/宿/保険/緊急）」を上から順に表示する。トップだけ見れば当日の行動が始められることをMVP条件とする。

2つ目は行程ページである。日付ごとに予定を並べ、各予定に「時間」「場所」「メモ」「関連リンク（地図・予約・公式サイト）」を紐づける。

3つ目は予約ページである。宿・移動（飛行機/鉄道/バス）・施設予約を種別で整理し、提示に必要な情報（予約番号、PDF/メールへのリンク、集合時間）をまとめる。

4つ目は緊急ページである。全員の連絡先、海外保険、パスポート控えの保管場所、現地での緊急時の行動メモを置く。

チェックリスト、予算、地図、旅行後の記録はMVPの「次の段階」とし、設計は用意するが必須完了条件からは外す。

## 2. 受け入れ条件（完成の判定基準）

機能面の受け入れ条件は次である。

第一に、共通パスワードを通らない限り、トップを含む全ページが閲覧できないこと。プレビュー環境（確認用URL）でも同様であること。これが満たされない限り機微情報を載せない運用とする。

第二に、スマホでトップを開いたときに「次の集合」が3スクロール以内に見えること。リンクが押しやすく、文字が読めること。

第三に、行程に追加された予定が、日付順に破綻なく並び、各予定から関連リンクへ遷移できること。

第四に、予約ページから「提示に必要な情報」に即到達できること。旅行当日に探す時間がゼロに近いことを狙う。

## 3. 画面要件（ページ構成と情報設計）

ページは次の構成で確定とする。

- `/` トップ：次の集合、今日/明日の予定、重要リンク、緊急導線
- `/itinerary` 行程一覧：日付タブまたは日付見出しの連続表示
- `/itinerary/[date]` 日付詳細：予定の詳細、当日のメモ
- `/bookings` 予約一覧：宿/移動/施設の3カテゴリ
- `/emergency` 緊急：連絡先、保険、控え、行動メモ

UIの原則は「上に重要、下に補足」「リンクは目立たせる」「長文は折りたたむ」で固定する。

## 4. データ要件（保持する項目と形式）

最初の実装は、GitHubリポジトリ内にデータファイルとして保持する方式（編集は幹事がPRで反映）を標準とする。データ形式はJSONで統一し、ページはJSONを読み込んで表示する。

最低限必要なデータ構造は次である。

- 行程データは、日付ごとの配列として「開始時刻」「終了時刻（任意）」「タイトル」「場所」「メモ」「リンク（地図URL、予約URL、公式URL）」を持つ。
- 予約データは「種別（hotel/transport/activity）」「名称」「日時」「予約番号」「提示URL（PDF/画像/メールへのリンク）」「住所」「メモ」を持つ。提示URLは基本的に外部ストレージ（Google Drive等）へのリンクでもよいが、アクセス制御の外に出ない運用を徹底する。
- 緊急データは「メンバー名」「電話」「緊急連絡先」「保険情報」「大使館・現地連絡先」「パスポート控えの保管先リンク」「行動メモ」を持つ。

## 5. アクセス制御要件（共通パスワード）

サイト全体を共通パスワードで保護する。実現方法は原則としてVercel側の保護機能を使用し、利用不可の場合はアプリ側（Next.jsのmiddleware）で全ルートに認証をかける。

運用要件として、パスワードは少なくとも「旅行開始前」「旅行終了後」に変更する前提とし、共有先は旅行メンバーに限定する。パスワードはGitHubに平文で置かず、Vercelの環境変数（またはVercel側設定）に置く。

## 6. 非機能要件（速度・可用性・保守）

表示速度は、スマホ回線でもトップが2〜3秒程度で実用になることを目標にする。画像を載せる場合は圧縮し、地図の埋め込みは必要時に読み込む（遅延読み込み）方針とする。

保守性として、行程と予約は「データファイルを直せば表示が変わる」設計にし、ページ側は汎用コンポーネントで繰り返し表示する。

## 7. 開発運用（GitHub・Vercel・Codex・Antigravityの役割）

GitHubでは、Issueに受け入れ条件を書き、Pull Requestでレビューしてmainにマージする。Vercelはmain更新で自動デプロイし、PRごとにプレビューURLを作って見た目と導線を確認する。

CodexとAntigravityは、(1) 画面の雛形作成、(2) JSON設計と読み込み、(3) モバイル表示の調整、(4) 簡単なテストとチェック、を担当させる。人間側は「ページ優先順位」「載せる情報の線引き」「パスワード運用」を決め切る。

## 次にやる実作業（この順で進める）

ここからは実装に直結する作業である。順番を固定する。

1. GitHubで新規リポジトリを作り、Issueを5本作る（Auth、Top、Itinerary、Bookings、Emergency）。各Issueの本文に上の受け入れ条件を貼る。
2. Next.js（推奨）で雛形を作り、Vercelに接続して「mainが自動公開」になるところまで通す。ここでプレビューURLが出る状態にする。
3. 共通パスワードを本番とプレビューの両方に適用し、外部から見えないことを確認する。これが通るまで機微情報を入れない。
4. `data/` 配下に `itinerary.json` `bookings.json` `emergency.json` を作り、仮データでページを組む。
5. 旅行情報を本データに置き換える。予約番号や住所などはこの時点で投入する。

## Codex/Antigravityに投げるための作業指示テンプレ

そのまま貼れる形で書く。

> Next.jsで旅行サイトを作る。ページは /, /itinerary, /bookings, /emergency の4つ。データは data/itinerary.json, data/bookings.json, data/emergency.json を読み込んで表示する。モバイル最適化を優先し、トップに次の集合と重要リンクを置く。共通パスワードで全ページを保護する前提だが、まずはUIとデータ読み込みを実装してほしい。型定義（TypeScript）を用意し、データが欠けていても落ちない表示にしてほしい。
